@model IEnumerable<DreamJourney.ViewModels.TripApplication.TripApplicationDetailsViewModel>

@{
    ViewData["Title"] = "Моите заявки";
}

<h1 class="text-center cta-tan-text mb-5">
    Моите резервации
</h1>

@if (!Model.Any())
{
    <p class="text-center text-muted fs-5">
        Нямате подадени заявки.
    </p>
}
else
{
    <div class="container">

        @foreach (var app in Model.OrderByDescending(a => a.Id))
        {
            <div class="card mb-4 shadow-sm border-0 hover-card w-100">
                <div class="card-body px-4 py-4">

                    <div class="row align-items-center text-center text-md-start">

                        <div class="col-md-4 mb-3 mb-md-0">
                            <div class="fw-bold fs-5">
                                @app.TripTitle
                            </div>
                            <div class="text-muted">
                                @app.TripDestinations
                            </div>
                        </div>

                        <div class="col-md-2 mb-3 mb-md-0 text-center">
                            <div class="fs-5 fw-semibold">
                                @app.PeopleCount
                            </div>
                            <div class="text-muted small">
                                Брой пътуващи
                            </div>
                        </div>

                        <div class="col-md-3 mb-3 mb-md-0 text-center">
                            @switch (app.Status)
                            {
                                case DreamJourney.Data.Models.Enums.ApplicationStatus.Pending:
                                    <span class="badge badge-muted px-4 py-2 fs-6">
                                        Изчаква
                                    </span>
                                    break;

                                case DreamJourney.Data.Models.Enums.ApplicationStatus.Accepted:
                                    <span class="badge badge-cadet px-4 py-2 fs-6">
                                        Приета
                                    </span>
                                    break;

                                case DreamJourney.Data.Models.Enums.ApplicationStatus.Completed:
                                    <span class="badge badge-tan px-4 py-2 fs-6">
                                        Завършена
                                    </span>
                                    break;

                                case DreamJourney.Data.Models.Enums.ApplicationStatus.Rejected:
                                    <span class="badge badge-danger px-4 py-2 fs-6">
                                        Отказана
                                    </span>
                                    break;
                            }
                        </div>

                        <div class="col-md-3 text-center">
                            <div class="d-flex justify-content-center gap-2 flex-wrap">

                                <a asp-controller="Trips"
                                   asp-action="Details"
                                   asp-route-id="@app.TripId"
                                   class="btn btn-outline-secondary btn-sm px-3">
                                    Детайли
                                </a>

                                @if (app.Status == DreamJourney.Data.Models.Enums.ApplicationStatus.Accepted)
                                {
                                    <a asp-controller="TripApplications"
                                       asp-action="Finalize"
                                       asp-route-id="@app.Id"
                                       class="btn btn-cta-cadetblue btn-sm px-3">
                                        Завърши
                                    </a>
                                }

                                @if (app.Status == DreamJourney.Data.Models.Enums.ApplicationStatus.Pending)
                                {
                                    <a asp-controller="TripApplications"
                                       asp-action="Cancel"
                                       asp-route-id="@app.Id"
                                       class="btn btn-outline-danger btn-sm px-3">
                                        Откажи
                                    </a>
                                }
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        }

    </div>
}
